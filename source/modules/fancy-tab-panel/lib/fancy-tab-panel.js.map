{"version":3,"sources":["../src/fancy-tab-panel.js"],"names":["Tab","iconStyle","width","FancyTabPanel","createClass","propTypes","onSelectTab","PropTypes","func","isRequired","selected","number","onAddTab","onRemoveTab","allowRemoveAll","bool","allowDnD","onFinishDrag","items","array","getDefaultProps","componentWillReceiveProps","props","newOnes","filter","state","find","ii","id","i","toDelete","forEach","o","type","recalculateTabPositions","slice","getInitialState","stateItems","totalWidth","tabPositions","res","length","setState","setTimeout","s","onContainerResize","contentRect","bounds","height","onClickRemove","e","stopPropagation","updateDrag","oldIdx","newIdx","callback","replacedTab","startDrag","idx","selObj","window","getSelection","removeAllRanges","document","onselectstart","tabDragState","endDrag","renderTab","tab","title","left","wedgeWidth","contentWidth","tabTitleWidth","tabStyle","tabContentStyle","pathD","lineHeight","tabClass","renderAddIcon","toLeft","lastTab","max","render","map","toString","measureRef","indexOf"],"mappings":"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","file":"fancy-tab-panel.js","sourcesContent":["import React from 'react'\r\nimport Measure from 'react-measure'\r\nimport './index.scss'\r\nimport {postpone, arrayToMap} from './util'\r\nimport {calculate} from './calculator'\r\nimport {TAB_HEIGHT, PANEL_HEIGHT, MAX_TAB_WIDTH, CROSS_WIDTH, ADD_WIDTH, TAB_ANIMATION_DURATION} from './constants'\r\nimport {TabGhostHandle} from './tab-ghost-handle'\r\nimport {TabDragState, Tab} from './tab'\r\n\r\nexport {Tab}\r\n\r\n//Logic\r\n//1. Use measure to get individual tab size\r\n//2. Calculate the max content width available\r\n//3. Calculate the \"left\" size\r\n\r\nconst iconStyle = {\r\n  width: CROSS_WIDTH+'px'\r\n}\r\n\r\nexport const FancyTabPanel = React.createClass({\r\n  propTypes: {\r\n    onSelectTab: React.PropTypes.func.isRequired,\r\n    selected: React.PropTypes.number.isRequired,\r\n    onAddTab: React.PropTypes.func,\r\n    onRemoveTab: React.PropTypes.func,\r\n    allowRemoveAll: React.PropTypes.bool,\r\n    allowDnD: React.PropTypes.bool,\r\n    onFinishDrag: React.PropTypes.func.isRequired,\r\n    items: React.PropTypes.array    //map of tabId to tabContent\r\n  },\r\n\r\n  getDefaultProps(){\r\n    return {\r\n      allowDnD: true,\r\n      allowRemoveAll: false\r\n    }\r\n  },\r\n\r\n  componentWillReceiveProps(props){\r\n    //compare with existing items and decide which ones are new, which ones are to be deleted\r\n    let newOnes = props.items.filter(i => !this.state.items.find(ii=>ii.id===i.id))\r\n    // console.log('Detected new tabs', newOnes)\r\n    let toDelete = this.state.items.filter(i => !props.items.find(ii=>ii.id===i.id))\r\n    // console.log('Detected deleted tabs', toDelete)\r\n\r\n    newOnes.forEach(o=>o.type='entering')\r\n    //combine the two lists of tabs\r\n    this.recalculateTabPositions(null, props.items.slice(0), toDelete)\r\n  },\r\n\r\n  getInitialState(){\r\n    let stateItems = this.props.items.slice(0)\r\n    return {\r\n      totalWidth: 0,\r\n      tabPositions: null,\r\n      items: stateItems   //copy into another array\r\n    }\r\n  },\r\n\r\n  recalculateTabPositions(totalWidth, items, toDelete = []){\r\n    totalWidth = totalWidth || this.state.totalWidth\r\n    items = items || this.state.items\r\n    let res = calculate(totalWidth, items.length, this.props.onRemoveTab, MAX_TAB_WIDTH)\r\n    this.setState({\r\n      totalWidth, items,\r\n      toDelete,\r\n      tabPositions: res\r\n    }, ()=>{\r\n      setTimeout(()=>{\r\n        this.setState(s=>{\r\n          s.items.forEach(o=>{\r\n            if(o.type==='entering')\r\n              o.type='normal'\r\n          })\r\n          s.toDelete = []\r\n        })\r\n      }, TAB_ANIMATION_DURATION)\r\n    })\r\n  },\r\n\r\n  onContainerResize(contentRect){\r\n    let {width, height} = contentRect.bounds\r\n    if(this.props.onAddTab){\r\n      width -= ADD_WIDTH\r\n    }\r\n    this.recalculateTabPositions(width)\r\n  },\r\n\r\n  onClickRemove(e, id){\r\n    e.stopPropagation();\r\n    this.props.onRemoveTab(id)\r\n  },\r\n\r\n  updateDrag(oldIdx, newIdx, callback){\r\n    this.setState(s=>{\r\n      //swap\r\n      let replacedTab = s.items[oldIdx]\r\n      s.items[oldIdx] = s.items[newIdx]\r\n      s.items[newIdx] = replacedTab\r\n    }, callback)\r\n  },\r\n\r\n  startDrag(e, idx, id){\r\n    this.props.onSelectTab(id)\r\n\r\n    if(this.props.allowDnD){\r\n      // Remove all existing selections on document, since they mess up the drag and drop effect\r\n      let selObj = window.getSelection()\r\n      selObj.removeAllRanges()\r\n      document.onselectstart = ()=>false  //prevent select start\r\n\r\n      this.setState({\r\n        tabDragState: new TabDragState(e, this.state.tabPositions, this.state.items, idx, this.endDrag, this.updateDrag)\r\n      })\r\n    }\r\n  },\r\n\r\n  endDrag(){\r\n    delete this.state.tabDragState\r\n    document.onselectstart = null  //enable select start\r\n    this.setState({\r\n      tabDragState: null\r\n    }, ()=>this.props.onFinishDrag(this.state.items))\r\n  },\r\n\r\n  //Required: calculatedTabState\r\n  renderTab(tab, idx){\r\n    let {id, title} = tab\r\n    if(this.state.totalWidth > 0 && this.state.tabPositions){\r\n      let {width, left, wedgeWidth, contentWidth} = this.state.tabPositions[idx]\r\n      let tabTitleWidth = this.props.onRemoveTab? contentWidth - CROSS_WIDTH : contentWidth;\r\n      let tabStyle = {\r\n        height: TAB_HEIGHT + 'px',\r\n        left: left+'px',\r\n        width: width+'px'\r\n      }\r\n      let tabContentStyle = {\r\n        ...tabStyle,\r\n        left: wedgeWidth + 'px',\r\n        width: contentWidth + 'px'\r\n      }\r\n      let pathD = `M ${width} ${TAB_HEIGHT} L ${width - wedgeWidth} 1 L ${wedgeWidth} 1 L 0 ${TAB_HEIGHT}`\r\n      if(id !== this.props.selected) {\r\n        pathD += ' Z'\r\n      }\r\n\r\n      if(tab.type === 'ghostPlaceholder'){\r\n        //A free moving, semi transparent ghost that does not interfere with other tabs\r\n        //Its position depends on the mouse position\r\n        if(!this.state.tabDragState || !this.state.tabPositions)\r\n          return null;\r\n        let pathD = `M ${width} ${TAB_HEIGHT} L ${width - wedgeWidth} 1 L ${wedgeWidth} 1 L 0 ${TAB_HEIGHT}`\r\n        return <TabGhostHandle tabDragState={this.state.tabDragState} key={id} tabStyle={tabStyle} title={title}>\r\n          <svg>\r\n            <path d={pathD}/>\r\n          </svg>\r\n          <div className='tab-content' style={tabContentStyle}>\r\n            <div className='tab-title no-select' style={{width: tabTitleWidth, lineHeight: TAB_HEIGHT+'px'}}>{title}</div>\r\n          </div>\r\n        </TabGhostHandle>\r\n      }\r\n\r\n      //set transform scale for newly entered\r\n      let tabClass = 'tab ' + (id===this.props.selected && ' selected ') + (tab.type === 'entering' && ' entering ')\r\n\r\n      return <div style={tabStyle} key={id} className={tabClass}>\r\n        <svg>\r\n          <path d={pathD}/>\r\n        </svg>\r\n        <div className='tab-content' style={tabContentStyle}>\r\n          <div className='tab-title no-select' style={{width: tabTitleWidth, lineHeight: TAB_HEIGHT+'px'}} onMouseDown={(e)=>this.startDrag(e, idx, id)}>{title}</div>\r\n          {this.props.onRemoveTab && (this.state.items.length > 1 || this.props.allowRemoveAll)? <div className='tab-delete-icon' style={{...iconStyle, height: TAB_HEIGHT+'px'}}>\r\n            <i className='fa fa-times' onClick={(e)=>this.onClickRemove(e, id)}/>\r\n          </div> : null}\r\n        </div>\r\n      </div>\r\n    }\r\n    return null\r\n  },\r\n\r\n  renderAddIcon(){\r\n      let toLeft = 0;\r\n      if(this.state.tabPositions && this.state.tabPositions.length > 0){\r\n        let lastTab = this.state.tabPositions.max(s=>s.left)\r\n        toLeft = lastTab.left + lastTab.width\r\n      }\r\n      return <div className='tab-add-button' style={{left: toLeft+'px', height: TAB_HEIGHT+'px', width: ADD_WIDTH +'px'}}>\r\n        <svg viewBox='0 0 100 100' onClick={this.props.onAddTab}>\r\n          {/*<path d='M 5 22 L 70 22 L 100 78 L 35 78 Z'/>*/}\r\n          <path d='M 20 20 L 80 20 L 80 80 L 20 80 Z'/>\r\n        </svg>\r\n        <i className='fa fa-plus'/>\r\n      </div>\r\n  },\r\n\r\n  render(){\r\n    // a trick to make sure tabs are rendered in a FIXED order, because re-arranging DOM elements has undefined behaviour in browsers\r\n    let map = arrayToMap(this.state.items, tab=>tab.id.toString())\r\n    return (\r\n      <div className='fancy-tab-panel'>\r\n        <Measure bounds onResize={this.onContainerResize}>\r\n          {({ measureRef }) =>\r\n            <div className='top-panel' ref={measureRef} style={{height: PANEL_HEIGHT+'px'}}>\r\n              {Object.keys( map ).map(id=>{\r\n                let tab = map[id]\r\n                let idx = this.state.items.indexOf(tab)\r\n                return this.renderTab(tab, idx)\r\n              })}\r\n              {this.props.onAddTab? this.renderAddIcon() : null}\r\n            </div>\r\n          }\r\n        </Measure>\r\n      </div>)\r\n  }\r\n})\r\n"]}